import{u as V,c as f,o as l,b as s,t as d,f as H,r as T,g as x,h as L,i as $,j as O,a as r,d as c,e as P,w as p,F as I,k as N,l as z,m as A,n as B,p as i}from"./index-BjBpr3Ih.js";import{u as G}from"./news-DcG85OwU.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{T as J}from"./TabBar-CkY-5Qov.js";import"./index-ngrFHoWO.js";import"./api-Cct3C2HD.js";const K={class:"news-content"},Q={class:"news-title"},W={class:"news-desc"},X={class:"news-info"},Y={class:"news-image"},Z=["src","alt"],ee={__name:"NewsItem",props:{news:{type:Object,required:!0}},setup(o){const t=o,w=V(),h=()=>{w.push(`/news/detail/${t.news.id}`)};return(C,u)=>(l(),f("div",{class:"news-item",onClick:h},[s("div",K,[s("h3",Q,d(o.news.title),1),s("p",W,d(o.news.description),1),s("div",X,[s("span",null,d(o.news.author),1),s("span",null,d(o.news.publishTime),1),s("span",null,d(o.news.views)+" 阅读",1)])]),s("div",Y,[s("img",{src:o.news.image,alt:o.news.title},null,8,Z)])]))}},te=E(ee,[["__scopeId","data-v-deb1e557"]]),ne={class:"home"},se={class:"more-options"},oe={class:"category-tabs"},ae={__name:"Home",setup(o){z(e=>({"3e80dcd0":k.value+"px"}));const t=G(),w=V(),h=A(),{t:C}=H(),u=T(0),k=T(0);x(()=>h.query.categoryId,e=>{if(e){const n=parseInt(e),v=t.categories.filter(_=>_.name!=="更多").findIndex(_=>_.id===n);v!==-1&&(u.value=v,t.changeCategory(n))}},{immediate:!0}),L(()=>{t.getCategories().then(()=>{t.getNewsList()}),setTimeout(b,300),window.addEventListener("scroll",y)});const R=$(()=>t.categories.filter(e=>e.name!=="更多"));$(()=>t.categories.filter(e=>e.name==="军事"||e.name==="科技"||e.name==="财经"));const S=e=>{const m={头条:"headline",社会:"society",国内:"domestic",国际:"international",娱乐:"entertainment",体育:"sports",军事:"military",科技:"technology",财经:"finance",更多:"more"}[e];return m?C(`home.categories.${m}`):e},M=()=>{w.push("/category")},b=()=>{const e=document.querySelector(".van-tabs__wrap");e&&(k.value=e.getBoundingClientRect().top)},y=()=>{b()};L(()=>{t.getNewsList(),setTimeout(b,300),window.addEventListener("scroll",y)}),O(()=>{window.removeEventListener("scroll",y)}),x(u,e=>{const n=t.categories[e].id;t.changeCategory(n)});const U=()=>{t.getNewsList(!0)},q=()=>{t.getNewsList()};return(e,n)=>{const m=c("van-nav-bar"),v=c("van-icon"),_=c("van-list"),j=c("van-pull-refresh"),D=c("van-tab"),F=c("van-tabs");return l(),f("div",ne,[r(m,{title:e.$t("home.title"),fixed:""},null,8,["title"]),s("div",se,[s("div",{class:"more-tab",onClick:M},[P(d(e.$t("home.more"))+" ",1),r(v,{name:"arrow"})])]),s("div",oe,[r(F,{active:u.value,"onUpdate:active":n[2]||(n[2]=g=>u.value=g),sticky:"",swipeable:"",animated:""},{default:p(()=>[(l(!0),f(I,null,N(R.value,(g,ie)=>(l(),B(D,{key:g.id,title:S(g.name),onClick:a=>i(t).changeCategory(g.id)},{default:p(()=>[r(j,{modelValue:i(t).refreshing,"onUpdate:modelValue":n[1]||(n[1]=a=>i(t).refreshing=a),onRefresh:U},{default:p(()=>[r(_,{loading:i(t).loading,"onUpdate:loading":n[0]||(n[0]=a=>i(t).loading=a),finished:i(t).finished,"finished-text":e.$t("home.noMore"),onLoad:q},{default:p(()=>[(l(!0),f(I,null,N(i(t).newsList,a=>(l(),B(te,{key:a.id,news:a},null,8,["news"]))),128))]),_:1},8,["loading","finished","finished-text"])]),_:1},8,["modelValue"])]),_:1},8,["title","onClick"]))),128))]),_:1},8,["active"])]),r(J)])}}},_e=E(ae,[["__scopeId","data-v-9bc6af8c"]]);export{_e as default};
